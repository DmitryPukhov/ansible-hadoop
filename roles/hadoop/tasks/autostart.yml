---

- name: Copy service files
  template:
    src: 'templates/etc/systemd/system/{{ item }}'
    dest: '/etc/systemd/system/{{ item }}'
    #sudo: yes
    force: true
    #mode: 0755
  with_items:
      - hadoop-namenode.service
      - hadoop-secondarynamenode.service
      - hadoop-datanode.service
      - yarn-nodemanager.service
      - yarn-resourcemanager.service
      - yarn-proxyserver.service

- name: Activate master daemons
  when: '"hadoop_master" in hadoop_type_of_node'
  service:
    name: '{{ item }}'
    enabled: yes
    state: reloaded
    state: started
  with_items:
      - hadoop-namenode
      - hadoop-secondarynamenode
      - yarn-resourcemanager
      - yarn-proxyserver

- name: Activate slave daemons
  when: '"hadoop_slave" in hadoop_type_of_node'
  service:
    name: '{{ item }}'
    enabled: yes
    state: reloaded
    state: started
  with_items:
      - hadoop-datanode
      - yarn-nodemanager
